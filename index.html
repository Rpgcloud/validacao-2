<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>O Bosque Murmurante</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a202c; /* Fundo escuro */
            color: #e2e8f0; /* Texto claro */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 1rem;
        }
        .game-container {
            background-color: #2d3748; /* Tom mais escuro para o container */
            border-radius: 1rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            max-width: 800px;
            width: 100%;
            padding: 2rem;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        .narrative-box {
            background-color: #4a5568;
            border-left: 4px solid #4299e1;
            padding: 1.5rem;
            border-radius: 0.5rem;
            line-height: 1.7;
        }
        .stat-bar {
            height: 10px;
            border-radius: 9999px;
            transition: width 0.5s ease-in-out;
        }
        .stat-bar-container {
            background-color: #718096;
            border-radius: 9999px;
            overflow: hidden;
        }
        .virtue-bar { background-color: #48bb78; }
        .vice-bar { background-color: #e53e3e; }

        .choice-button {
            background-color: #4a5568;
            transition: transform 0.2s, background-color 0.2s;
        }
        .choice-button:hover {
            transform: translateY(-3px);
            background-color: #616e81;
        }
        .restart-btn {
            background-color: #6b46c1;
            transition: background-color 0.2s;
        }
        .restart-btn:hover {
            background-color: #805ad5;
        }
    </style>
</head>
<body>

<div id="game-container" class="game-container">
    <h1 class="text-3xl font-bold text-center text-white">O Bosque Murmurante</h1>

    <!-- Stats Section -->
    <div id="stats-section" class="flex flex-col md:flex-row justify-between gap-4">
        <div class="w-full">
            <h2 class="text-lg font-bold mb-1 text-green-400">Virtudes</h2>
            <div class="flex items-center gap-2 mb-2">
                <span class="text-sm w-24">Coragem:</span>
                <div class="stat-bar-container w-full">
                    <div id="virtue-courage-bar" class="stat-bar virtue-bar" style="width: 0%;"></div>
                </div>
            </div>
            <div class="flex items-center gap-2 mb-2">
                <span class="text-sm w-24">Sabedoria:</span>
                <div class="stat-bar-container w-full">
                    <div id="virtue-wisdom-bar" class="stat-bar virtue-bar" style="width: 0%;"></div>
                </div>
            </div>
            <div class="flex items-center gap-2 mb-2">
                <span class="text-sm w-24">Compaixão:</span>
                <div class="stat-bar-container w-full">
                    <div id="virtue-compassion-bar" class="stat-bar virtue-bar" style="width: 0%;"></div>
                </div>
            </div>
        </div>
        <div class="w-full">
            <h2 class="text-lg font-bold mb-1 text-red-400">Vícios</h2>
            <div class="flex items-center gap-2 mb-2">
                <span class="text-sm w-24">Crueldade:</span>
                <div class="stat-bar-container w-full">
                    <div id="vice-cruelty-bar" class="stat-bar vice-bar" style="width: 0%;"></div>
                </div>
            </div>
            <div class="flex items-center gap-2 mb-2">
                <span class="text-sm w-24">Ambição:</span>
                <div class="stat-bar-container w-full">
                    <div id="vice-ambition-bar" class="stat-bar vice-bar" style="width: 0%;"></div>
                </div>
            </div>
            <div class="flex items-center gap-2 mb-2">
                <span class="text-sm w-24">Futilidade:</span>
                <div class="stat-bar-container w-full">
                    <div id="vice-futility-bar" class="stat-bar vice-bar" style="width: 0%;"></div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Narrative and Choices Section -->
    <div class="narrative-box" id="narrative-container">
        <p id="narrative-text" class="text-lg"></p>
    </div>

    <div id="choices-container" class="grid grid-cols-1 sm:grid-cols-2 gap-4">
        <!-- Buttons will be dynamically added here -->
    </div>

    <!-- End Game Modal -->
    <div id="end-modal" class="hidden fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4">
        <div class="bg-gray-700 rounded-lg p-8 max-w-lg w-full text-center">
            <h2 id="end-title" class="text-3xl font-bold mb-4 text-white"></h2>
            <p id="end-text" class="text-lg leading-relaxed text-gray-200 mb-6"></p>
            <button id="restart-btn" class="restart-btn text-white font-bold py-3 px-8 rounded-lg">Jogar Novamente</button>
        </div>
    </div>
</div>

<script>
    // Game Data: a more complex structure to handle dynamic choices
    const gameData = {
        'start': {
            narrative: "Você acorda sob a luz pálida da lua, no coração do Bosque Murmurante. Uma voz suave, mas persistente, ecoa em sua mente: 'Busque o Coração do Bosque. Só ele pode silenciar os lamentos desta terra'. Uma trilha se divide à sua frente. Para onde você vai?",
            choices: [
                { text: "Siga o caminho da luz, que brilha com uma aura pacífica.", next: 'path_of_light', virtues: { courage: 1, compassion: 1 } },
                { text: "Siga o caminho da sombra, que promete segredos ancestrais.", next: 'path_of_shadow', vices: { ambition: 1, futility: 1 } }
            ]
        },
        'path_of_light': {
            narrative: "O caminho da luz leva você a uma clareira onde uma criatura de cristal, ferida, chora. Seus cristais tremem, emitindo uma melodia dolorosa.",
            choices: [
                { text: "Tente curar a criatura com um toque gentil.", next: 'heal_creature', virtues: { compassion: 2, wisdom: 1 } },
                { text: "Ignore a criatura e procure um atalho, não há tempo para desvios.", next: 'ignore_creature', vices: { futility: 2 } },
                { text: "Quebre um dos cristais para analisar a sua luz.", next: 'break_crystal', vices: { cruelty: 2 } }
            ]
        },
        'path_of_shadow': {
            narrative: "O caminho da sombra o leva a um abismo. Uma ponte de pedra, coberta de runas, estende-se sobre o vazio. No centro, uma gárgula de pedra murmura enigmas.",
            choices: [
                { text: "Tente decifrar as runas e o enigma da gárgula.", next: 'solve_enigma', virtues: { wisdom: 2 } },
                { text: "Tente pular o abismo com um salto ousado.", next: 'jump_abyss', virtues: { courage: 2 } },
                { text: "Ofereça algo de valor à gárgula em troca de passagem.", next: 'bribe_gargoyle', vices: { ambition: 1 } }
            ]
        },
        'heal_creature': {
            narrative: "Sua compaixão cura a criatura. Ela, em gratidão, revela que a próxima etapa da sua jornada está em um pântano e lhe entrega uma flor luminosa que repele as criaturas das trevas. Você continua sua jornada.",
            choices: [
                { text: "Continue sua jornada para o pântano.", next: 'swamp_journey', virtues: { compassion: 1 } }
            ]
        },
        'ignore_creature': {
            narrative: "Você ignora a criatura e corre pela floresta. A melodia dolorosa da criatura se mistura com os lamentos da floresta e você sente uma dor no peito. A escuridão ao seu redor cresce.",
            choices: [
                { text: "Tente encontrar uma saída.", next: 'lost_in_the_forest', vices: { futility: 1 } }
            ]
        },
        'break_crystal': {
            narrative: "Você quebra o cristal, e a criatura grita de dor. O cristal se desintegra em poeira e você não encontra nada de valor. A floresta inteira treme e você sente a sua energia vital sendo drenada. Você continua sua jornada.",
            choices: [
                { text: "Continue sua jornada. A dor da criatura parece ter te deixado mais forte.", next: 'gain_power_from_pain', vices: { cruelty: 1, ambition: 1 } }
            ]
        },
        'solve_enigma': {
            narrative: "Você decifra o enigma. A gárgula se move e uma escada de pedra surge do abismo. No fundo, você encontra uma antiga adaga, capaz de cortar a escuridão. Você continua sua jornada.",
            choices: [
                { text: "Continue sua jornada.", next: 'deep_caves_of_shadows', virtues: { wisdom: 1 } }
            ]
        },
        'jump_abyss': {
            narrative: "Você pula o abismo, mas a sua coragem é falha. Você cai no abismo.",
            choices: [
                { text: "O fim de sua jornada...", next: 'bad_end' }
            ]
        },
        'bribe_gargoyle': {
            narrative: "Você oferece um objeto de valor à gárgula, mas ela não se move. Ela apenas ri de você e te empurra para o abismo.",
            choices: [
                { text: "O fim de sua jornada...", next: 'bad_end' }
            ]
        },
        'swamp_journey': {
            narrative: "O pântano é silencioso, mas a flor luminosa em sua mão te dá confiança. Você caminha com facilidade por entre as criaturas, que se afastam de você. Você encontra a entrada para uma caverna.",
            choices: [
                { text: "Entre na caverna.", next: 'inside_the_cave', virtues: { courage: 1 } }
            ]
        },
        'lost_in_the_forest': {
            narrative: "Você se perde na floresta. A escuridão te consome, e você sente que nunca mais sairá daqui. A dor da criatura de cristal te assombra.",
            choices: [
                { text: "O fim de sua jornada...", next: 'bad_end' }
            ]
        },
        'gain_power_from_pain': {
            narrative: "A dor da criatura de cristal parece ter te dado um poder. Você consegue ver as auras das criaturas da floresta. Você continua sua jornada, mas a escuridão ao seu redor te segue.",
            choices: [
                { text: "Siga em frente.", next: 'confrontation_with_the_guardian', vices: { ambition: 1 } }
            ]
        },
        'deep_caves_of_shadows': {
            narrative: "As cavernas são cheias de sombras, mas a adaga que você tem as repele. Você encontra o coração do bosque. Uma aura de energia emite do artefato e você pode escolher o que fazer com ela.",
            choices: [
                { text: "Use a energia do coração para se tornar um herói.", next: 'end_hero', virtues: { courage: 1, wisdom: 1 } },
                { text: "Use a energia do coração para se tornar um deus.", next: 'end_tyrant', vices: { ambition: 1, cruelty: 1 } }
            ]
        },
        'inside_the_cave': {
            narrative: "A caverna é silenciosa. Você avança até encontrar um enorme golem de pedra. O golem está dormindo e uma relíquia de grande poder está em suas mãos. O que você faz?",
            choices: [
                { text: "Tente se aproximar silenciosamente e roubar a relíquia.", next: 'steal_relic', vices: { futility: 1, ambition: 1 } },
                { text: "Tente acordar o golem com uma canção suave e pacífica.", next: 'wake_golem', virtues: { compassion: 1, wisdom: 1 } },
                { text: "Tente acordar o golem para uma luta.", next: 'fight_golem', vices: { cruelty: 1, ambition: 1 } }
            ]
        },
        'confrontation_with_the_guardian': {
            narrative: "Você encontra um ser guardião do bosque. Ele diz que você está no caminho errado, e que a sua alma está se corrompendo. O que você faz?",
            choices: [
                { text: "Aceita as palavras do guardião e tente se redimir.", next: 'redemption', virtues: { wisdom: 1, compassion: 1 } },
                { text: "Não se importa com o que ele diz e o ataca.", next: 'end_tyrant', vices: { cruelty: 1, ambition: 1 } }
            ]
        },
        'steal_relic': {
            narrative: "Você tenta roubar a relíquia, mas o golem acorda. Ele te esmaga com a mão.",
            choices: [
                { text: "O fim de sua jornada...", next: 'bad_end' }
            ]
        },
        'wake_golem': {
            narrative: "Sua canção acalma o golem. Ele entrega a relíquia a você e te mostra o caminho para fora da caverna. A relíquia te dá um poder enorme.",
            choices: [
                { text: "Use a relíquia para se tornar um herói.", next: 'end_hero', virtues: { courage: 1, wisdom: 1 } },
                { text: "Use a relíquia para se tornar um deus.", next: 'end_tyrant', vices: { ambition: 1, cruelty: 1 } }
            ]
        },
        'fight_golem': {
            narrative: "Você ataca o golem, mas ele te esmaga com a mão.",
            choices: [
                { text: "O fim de sua jornada...", next: 'bad_end' }
            ]
        },
        'redemption': {
            narrative: "Você se redime e se torna um herói. O guardião te ajuda a encontrar o caminho para o coração do bosque e você o restaura.",
            choices: [
                { text: "Aceite o convite do guardião para ficar e proteger o bosque.", next: 'end_hero' }
            ]
        },

        // Endings
        'bad_end': { narrative: "A escuridão do bosque te consumiu.", is_ending: true },
        'end_hero': { narrative: "Você restaurou o equilíbrio do bosque. As Virtudes que você cultivou te tornaram um herói. Seu nome é ecoado pelas árvores e você se torna um protetor da vida.", is_ending: true },
        'end_tyrant': { narrative: "Você usou o poder para seu próprio ganho. O bosque, outrora vibrante, agora se curva à sua vontade. As sombras te abraçam. Você se torna um tirano, mas solitário em sua ambição. A sua jornada termina, mas o seu reinado de trevas apenas começou.", is_ending: true }
    };

    // Game state
    let stats = {
        virtues: { courage: 0, wisdom: 0, compassion: 0 },
        vices: { cruelty: 0, ambition: 0, futility: 0 }
    };
    let currentNodeId = 'start';
    const STAT_MAX = 10;

    // DOM elements
    const narrativeTextEl = document.getElementById('narrative-text');
    const choicesContainerEl = document.getElementById('choices-container');
    const endModal = document.getElementById('end-modal');
    const endTitleEl = document.getElementById('end-title');
    const endTextEl = document.getElementById('end-text');
    const restartBtn = document.getElementById('restart-btn');

    // Functions
    function updateStatsUI() {
        for (const statType in stats) {
            for (const statName in stats[statType]) {
                const bar = document.getElementById(`${statType}-${statName}-bar`);
                if (bar) {
                    const percentage = (stats[statType][statName] / STAT_MAX) * 100;
                    bar.style.width = `${Math.min(percentage, 100)}%`;
                }
            }
        }
    }

    function displayNode(nodeId) {
        const node = gameData[nodeId];
        if (!node) {
            console.error("Node not found:", nodeId);
            return;
        }

        if (node.is_ending) {
            showEnding(node.narrative);
            return;
        }

        narrativeTextEl.textContent = node.narrative;
        choicesContainerEl.innerHTML = '';
        node.choices.forEach(choice => {
            const button = document.createElement('button');
            button.className = "choice-button text-left text-white font-medium py-4 px-6 rounded-lg text-lg hover:bg-gray-700 transition-colors";
            button.textContent = choice.text;
            button.onclick = () => handleChoice(choice);
            choicesContainerEl.appendChild(button);
        });
        updateStatsUI();
    }

    function handleChoice(choice) {
        // Update stats based on choice
        if (choice.virtues) {
            for (const virtue in choice.virtues) {
                stats.virtues[virtue] += choice.virtues[virtue];
                stats.virtues[virtue] = Math.min(stats.virtues[virtue], STAT_MAX);
            }
        }
        if (choice.vices) {
            for (const vice in choice.vices) {
                stats.vices[vice] += choice.vices[vice];
                stats.vices[vice] = Math.min(stats.vices[vice], STAT_MAX);
            }
        }
        
        currentNodeId = choice.next;
        displayNode(currentNodeId);
    }

    function showEnding(text) {
        endTitleEl.textContent = "FIM DA JORNADA";
        endTextEl.textContent = text;
        endModal.classList.remove('hidden');
    }

    function restartGame() {
        stats = {
            virtues: { courage: 0, wisdom: 0, compassion: 0 },
            vices: { cruelty: 0, ambition: 0, futility: 0 }
        };
        currentNodeId = 'start';
        endModal.classList.add('hidden');
        displayNode(currentNodeId);
    }

    // Event Listeners
    restartBtn.addEventListener('click', restartGame);

    // Initial game load
    window.onload = () => displayNode(currentNodeId);
</script>
</body>
</html>
